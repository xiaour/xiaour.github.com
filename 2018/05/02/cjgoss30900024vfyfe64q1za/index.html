<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>简单好用-JAVA使用POI解析Excel | 张涛的博客·XIAOUR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="相信使用POI的目前已经非常多了，我这边提供一个非常简单便利又通用的POI解析工具类，代码最后有示例代码。可以按照本文直接使用。  import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.io.InputStream; import j">
<meta name="keywords" content="张涛的博客·XIAOUR，JAVA技术博客，Spring Mvc，SpringBoot">
<meta property="og:type" content="article">
<meta property="og:title" content="简单好用-JAVA使用POI解析Excel">
<meta property="og:url" content="http://totube.cn/2018/05/02/cjgoss30900024vfyfe64q1za/index.html">
<meta property="og:site_name" content="张涛的博客·XIAOUR">
<meta property="og:description" content="相信使用POI的目前已经非常多了，我这边提供一个非常简单便利又通用的POI解析工具类，代码最后有示例代码。可以按照本文直接使用。  import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.io.InputStream; import j">
<meta property="og:locale" content="ZH_CN">
<meta property="og:updated_time" content="2018-05-02T07:45:38.894Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="简单好用-JAVA使用POI解析Excel">
<meta name="twitter:description" content="相信使用POI的目前已经非常多了，我这边提供一个非常简单便利又通用的POI解析工具类，代码最后有示例代码。可以按照本文直接使用。  import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.io.InputStream; import j">
  
    <link rel="alternate" href="/atom.xml" title="张涛的博客·XIAOUR" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">张涛的博客·XIAOUR</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">张涛的博客-XIAOUR</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://totube.cn"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-简单好用-JAVA使用POI解析Excel" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/02/cjgoss30900024vfyfe64q1za/" class="article-date">
  <time datetime="2018-05-02T07:43:43.000Z" itemprop="datePublished">2018-05-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      简单好用-JAVA使用POI解析Excel
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>相信使用POI的目前已经非常多了，我这边提供一个非常简单便利又通用的POI解析工具类，代码最后有示例代码。可以按照本文直接使用。</p>
<pre><code>
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.apache.log4j.LogManager;
import org.apache.log4j.Logger;
import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFDateUtil;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;

/**
 * 
 * Title: ExcelReader<br>
 * Description: 可以读取xls,xlsx等文件<br>
 * Copyright @ 2012~2016 xiaour.github.com<span style="font-size: 1em;"> .All rights reserved.<br></span>
 * @author  小鱼儿
 * @createDate 2016年8月23日
 * @version v1.0
 */
public class ExcelReader {
    private POIFSFileSystem fs;
    private HSSFWorkbook wb;
    private HSSFSheet sheet;
    private HSSFRow row;
    private static Logger logger = LogManager.getLogger(ExcelReader.class);

    private String fileFullPath;

    private int sheetNo;



    public ExcelReader(String fileFullPath, int sheetNo) {
        super();
        this.fileFullPath = fileFullPath;
        this.sheetNo = sheetNo;
    }

    /**
     * 读取Excel数据内容
     * @param InputStream 
     * @param sheetNo sheet 页号
     * @return Map 包含单元格数据内容的Map对象
     */
    public List<map<string,object>> readExcel() {
        logger.info("开始解析xls...");
        sheetNo--;//从1开始及从0开始
        InputStream is = null;
        try {
            is = new FileInputStream(fileFullPath);
        } catch (FileNotFoundException e1) {
            logger.error(e1);
        }
        Map<string,object> dataMap = null;
        List<map<string,object>> dataList= new ArrayList<>();
        String value = "";
         try {
             fs = new POIFSFileSystem(is);
             wb = new HSSFWorkbook(fs);
         } catch (IOException e) {
             logger.error(e);
         }
         sheet = wb.getSheetAt(sheetNo);
         row = sheet.getRow(0);
         // 标题总列数
         int colNum = row.getPhysicalNumberOfCells();
         String[] keyArray = new String[colNum];
         for (int i = 0; i < colNum; i++) {
             keyArray[i] = getCellFormatValue(row.getCell((short) i));
         }
        int rowNum = sheet.getLastRowNum();
        // 正文内容应该从第二行开始,第一行为表头的标题
        for (int i = 2; i <= rownum;="" i++)="" {="" datamap="new" hashmap<="">();
            row = sheet.getRow(i);
            if(row!=null){
                int j = 0;
                while (j < colNum) {
                    //这里把列循环到Map
                    if(row.getCell((short) j)!=null){
                    value = getCellFormatValue(row.getCell((short) j)).trim();
                    dataMap.put(keyArray[j],value);
                    }
                    j++;
                }
                value = "";
                dataList.add(dataMap);
            }
        }
        logger.info("解析xls完成...");
        try {
            if(is!=null)
            is.close();
        } catch (IOException e) {
            logger.error(e.toString());
        }
        return dataList;
    }

    /**
     * 根据HSSFCell类型设置数据
     * @param cell
     * @return
     */
    private String getCellFormatValue(HSSFCell cell) {
        String cellvalue = "";
        if (cell != null) {
            // 判断当前Cell的Type
            switch (cell.getCellType()) {
            // 如果当前Cell的Type为NUMERIC
            case HSSFCell.CELL_TYPE_NUMERIC:
            case HSSFCell.CELL_TYPE_FORMULA: {
                // 判断当前的cell是否为Date
                if (HSSFDateUtil.isCellDateFormatted(cell)) {
                    Date date = cell.getDateCellValue();
                    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
                    cellvalue = sdf.format(date);
                }
                // 如果是纯数字
                else {
                    // 取得当前Cell的数值
                    DecimalFormat df = new DecimalFormat("0");  
                    String dfStr = df.format(cell.getNumericCellValue()); 
                    cellvalue = dfStr;
                }
                break;
            }
            // 如果当前Cell的Type为STRIN
            case HSSFCell.CELL_TYPE_STRING:
                // 取得当前的Cell字符串
                cellvalue = cell.getRichStringCellValue().getString();
                break;
            // 默认的Cell值
            default:
                cellvalue = " ";
            }
        } else {
            cellvalue = "";
        }
        return cellvalue;

    }

    public static void main(String[] args) {
            List<map<string, object="">> dataList;
            // 对读取Excel表格标题测试
            ExcelReader excelReader = new ExcelReader("D:\\okcoin-2016-08-3XZS.xls",1);
            dataList = excelReader.readExcel();
            for(Map<string,object> theMap:dataList){
                System.out.println(theMap);
            }
    }
}
</string,object></map<string,></=></map<string,object></string,object></map<string,object></code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://totube.cn/2018/05/02/cjgoss30900024vfyfe64q1za/" data-id="cjgoss30900024vfyfe64q1za" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/05/02/cjgoss30300004vfyb10ujgdj/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">SpringMVC配置太多？试试SpringBoot</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/02/cjgoss30900024vfyfe64q1za/">简单好用-JAVA使用POI解析Excel</a>
          </li>
        
          <li>
            <a href="/2018/05/02/cjgoss30300004vfyb10ujgdj/">SpringMVC配置太多？试试SpringBoot</a>
          </li>
        
          <li>
            <a href="/2018/05/02/cjgoss30700014vfyw78a12yf/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 张涛·XIAOUR<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>